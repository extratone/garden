---
{"dg-publish":true,"permalink":"/written/5-b7950-b5-f8-a6-461-d-83-fa-b0-c585-f26-e8-f/","dgHomeLink":true,"dgPassFrontmatter":false}
---

// setup and request credentials
let credential = Credential.create("WriteFreely", "Enter the API base URL you intend to use and an auth token for your account.");

credential.addPasswordField("token", "Access Token");
credential.authorize();

const token = credential.getValue("token");

// make post
let endpoint = `https://write.as/api/posts`;

let data = {
  "body": draft.content,
  "title": draft.title,
};

// create and post HTTP request
var http = HTTP.create();

var response = http.request({
  "url": endpoint,
  "method": "POST",
  "data": data,
  "headers": {
    "Authorization": token,
  }
});

if (response.statusCode == 201) {
  console.log(response)
  app.setClipboard(response)
} else {
  console.log("Write.as Error: " + response.error);
  context.fail();
}